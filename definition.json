{
    "actionClass": ["Fusio\\Adapter\\Sample\\Action\\TodoFetchAllCustom"],
    "schema": [
        {
            "name": "Todo",
            "source": {
                "type": "object",
                "title": "todo",
                "properties": {
                    "id": {
                        "type": "integer"
                    },
                    "status": {
                        "type": "integer"
                    },
                    "title": {
                        "type": "string"
                    },
                    "insertDate": {
                        "type": "string",
                        "format": "date-time"
                    }
                }
            }
        },
        {
            "name": "Todo-Message",
            "source": {
                "type": "object",
                "title": "message",
                "properties": {
                    "success": {
                        "type": "boolean"
                    },
                    "message": {
                        "type": "string"
                    }
                }
            }
        },
        {
            "name": "Todo-Collection",
            "source": {
                "id": "http:\/\/acme.com\/schema",
                "type": "object",
                "title": "collection",
                "properties": {
                    "totalCount": {
                        "type": "integer"
                    },
                    "entry": {
                        "type": "array",
                        "items": {
                            "$ref": "schema:\/\/\/Todo"
                        }
                    }
                }
            }
        }
    ],
    "action": [
        {
            "name": "Todo-All-Custom",
            "class": "Fusio\\Adapter\\Sample\\Action\\TodoFetchAllCustom",
            "config": {
                "connection": "Native-Connection"
            }
        },
        {
            "name": "Todo-All",
            "class": "Fusio\\Impl\\Action\\SqlFetchAll",
            "config": {
                "connection": "Native-Connection",
                "propertyName": "entry",
                "sql": "  SELECT id, \n         status, \n         title, \n         insertDate \n    FROM app_todo \n   WHERE status = 1\nORDER BY insertDate DESC\n   LIMIT 0, 8"
            }
        },
        {
            "name": "Todo-Insert",
            "class": "Fusio\\Impl\\Action\\SqlExecute",
            "config": {
                "connection": "Native-Connection",
                "sql": "INSERT INTO app_todo (status, title, insertDate)\nVALUES (\n  1,\n  {{ body.get(\"\/title\")|prepare }},\n  datetime()\n)"
            }
        },
        {
            "name": "Todo-Delete",
            "class": "Fusio\\Impl\\Action\\SqlExecute",
            "config": {
                "connection": "Native-Connection",
                "sql": "UPDATE app_todo\n   SET status = 0\n WHERE id = {{ request.uriFragments.get(\"todo_id\")|prepare }}"
            }
        },
        {
            "name": "Todo-Row",
            "class": "Fusio\\Impl\\Action\\SqlFetchRow",
            "config": {
                "connection": "Native-Connection",
                "sql": "SELECT id, \n       status, \n       title, \n       insertDate \n  FROM app_todo \n WHERE id = {{ request.uriFragment(\"todo_id\")|prepare }}"
            }
        },
        {
            "name": "Todo-Update",
            "class": "Fusio\\Impl\\Action\\SqlExecute",
            "config": {
                "connection": "Native-Connection",
                "sql": "UPDATE app_todo\n   SET status = {{ body.get(\"\/status\")|prepare }},\n       title = {{ body.get(\"\/title\")|prepare }}\n WHERE id = {{ request.uriFragments.get(\"todo_id\")|prepare }}"
            }
        }
    ],
    "database": [
        {
            "name": "app_todo",
            "columns": [
                {
                    "name": "id",
                    "type": "integer"
                },
                {
                    "name": "status",
                    "type": "integer"
                },
                {
                    "name": "title",
                    "type": "string"
                },
                {
                    "name": "insertDate",
                    "type": "datetime"
                }
            ],
            "indexes": [
                {
                    "name": "PRIMARY",
                    "columns": ["id"],
                    "primary": true
                }
            ]
        }
    ],
    "routes": [
        {
            "path": "\/todo",
            "config": [
                {
                    "status": 4,
                    "version": 1,
                    "methods": {
                        "GET": {
                            "active": true,
                            "public": true,
                            "action": "Todo-All-Custom",
                            "response": "Todo-Collection"
                        },
                        "POST": {
                            "active": true,
                            "action": "Todo-Insert",
                            "request": "Todo",
                            "response": "Todo-Message"
                        },
                        "PUT": {
                            "active": false
                        },
                        "DELETE": {
                            "active": false
                        }
                    }
                }
            ]
        },
        {
            "path": "\/todo\/:todo_id",
            "config": [
                {
                    "status": 4,
                    "version": 1,
                    "methods": {
                        "GET": {
                            "active": true,
                            "public": true,
                            "action": "Todo-Row",
                            "response": "Todo"
                        },
                        "POST": {
                            "active": false
                        },
                        "PUT": {
                            "active": true,
                            "action": "Todo-Update",
                            "request": "Todo",
                            "response": "Todo-Message"
                        },
                        "DELETE": {
                            "active": true,
                            "action": "Todo-Delete",
                            "response": "Todo-Message"
                        }
                    }
                }
            ]
        }
    ]
}
